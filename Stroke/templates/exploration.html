<!DOCTYPE html>
<html lang="en">

<head>
  <title>Stroke Exploration & Analysis</title>

  <!-- Jquery -->
<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
crossorigin="anonymous"></script>
<!-- load header -->
<script>  $(function () {$('#header').load('head')})</script>
<div id=header></div>

</head>

<body>
  <!--Navbar-->
  <!-- load navbar -->
  <script> $(function () {$('#mybar').load('nav')})</script>
  <div id=mybar></div>

  <div class="row text-center" style="margin-top:5%">
    <div class = "col-md-12">
        <h6 class="display-4">Stroke Exploration & Analysis</h6>
    </div>
  </div>

  <!--METHOD-->
  <div class= "container-fluid">
    <div class="row" style="margin-top:3%">
      <div class = "col-md-12">
          <blockquote class="blockquote text-center">
              <p class="mb-0">We sourced our data from the Stroke Prediction Dataset on the <a href="https://www.kaggle.com/fedesoriano/stroke-prediction-dataset"><b> Kaggle </b></a> website.
              </p>
          </blockquote>
          <br>
      </div>
    </div>

    <!--DATA GATHERING and REVIEW-->
    <div class="row">
      <div class = "col-md-12">
          <h3><b>Data Gathering</b></h3>
          <br>
      </div>
    </div>
    <div class="row">
      <div class = "col-md-12">
          <blockquote class="blockquote">
              <p class="mb-0">
                <img src="../static/images/data review/attributes.PNG" alt = "attributes" style="float:left;width:35%;padding:2%;">
              <br>
              We chose to Stoke Prediction Datase as it was rich with information regarding the incidence of stroke and permitted us to develop a robust model that to predict it.
              <br>
              <br>The dataset was downloaded as a .csv file to explore and clean for data analysis and modeling.
              </p>
            </blockquote>
      </div>
    </div>

    <!--DATA CLEANING and PREP-->
    <div class="row" style="margin-top:5%">
      <div class = "col-md-12">
          <h3><b>Data Cleaning</b></h3>
          <br>
      </div>
    </div>
    <div class="row">
      <div class = "col-md-12">
        <blockquote class="blockquote">
            <p class="mb-0">
              <img src="../static/images/data review/age_corr.PNG" alt = "age stroke corr" style="float:left;width:35%;padding:2%;">
              <br>
              <br>
              Data cleaning was conducted in Jupyter Notebook using Python. 
              The raw dataset for machine learning consists of 5110 unique rows of information.  
              There were 2,994 (58.60%) “Females”, 2,115 (41.40%) “Males” and 1 “Other” in the gender attribute.  
              The “Other” gender was dropped from the dataset for a resulting dataset of 5,109 unique rows.  A quick
              review of the data indicated that 92% of the strokes in the dataset occurred in individuals over the 
              age of 50 
            </p>
        </blockquote>
      </div>
    </div>
    <br>
    <div class="row">
      <div class = "col-md-12">
        <blockquote class="blockquote">
            <p class="mb-0">
              <img src="../static/images/machine learning data prep/one_hot_encoding.PNG" alt = "one hot" style="float:left;width:35%;padding:2%;">
              <br>
              In reviewing the raw data, the bmi attribute was identified as having 201 “N/A” values.  This 
              represents 3.9% of the dataset.  The mean bmi value of 28.89 was used as the replacement value for 
              the “N/A” values. As noted above in the representation data tables, the raw dataset has a total 1,544 
              “Unknown” smoking status values representing 30.4% of the dataset.  A closer look at the data showed 
              32% of the “Unknown” values were between the ages of 0-10 and 41% was between the ages of 0-15.   The 
              Centers for Disease Control and Prevention (CDC) defines a current smoker as an Adult who has previously 
              smoked 100 cigarettes in their lifetime and who currently smokes.   Research of online literature to address 
              this issue of “Unknown” labels was conducted and it was found that “Unknown” is an accepted category.   The 
              final decision was to leave the “Unknown” smoker status values as presented in the raw dataset.   
              One-Hot Encoding was used for categorical data work_type, and smoking_status to be used in the linear 
              and tree models. One-Hot Encoding was used for categorical data work_type and smoking_status to be used 
              in the linear and tree models.               
            </p>
            <br>
        </blockquote>
      </div>
    </div>
    <div class="row">
      <div class = "col-md-12">
        <blockquote class="blockquote">
            <p class="mb-0">
              <img src="../static/images/machine learning data prep/stroke.PNG" alt = "stroke hist" style="float:left;width:35%;padding:2%;">
              <br>
              <br>
              Most of the data was biased in the histograms, except for age and Residence_type. For the Yes/No questions, 
              the data was left biased correlating to 0 which presents No as the answer to the respective question.   BMI 
              and average_glucose was left biased representing the lower end of their broad spectrum of data points. Example 
              histogram for stroke.
            </p>
        </blockquote>
      </div>
    </div>
    <br>

    <div class="row">
      <div class = "col-md-12">
        <blockquote class="blockquote">
            <p class="mb-0">
              There is a large imbalance of stroke incidents in the dataset.  To improve the model learning capabilities, 
              bias was addressed using SMOTE.
            </p>
        </blockquote>
      </div>
    </div>

    <div class="row">
      <div class = "col-md-6">
          <blockquote class="blockquote">
              <p class="mb-0" class="center">
                Pre-Smote
              </p>
          </blockquote>
      </div>
      <div class = "col-md-6">
          <blockquote class="blockquote">
              <p class="mb-0" class="center">
                Post-Smote
              </p>
          </blockquote>
      </div>
    </div>
    <div class="row">
      <div class = "col-md-6">
        <img src="../static/images/machine learning data prep/stroke_pre_synth.PNG" alt="pre smote" style="width:65%;padding:2%;" class="center">
      </div>
      <div class = "col-lg-6">
        <img src="../static/images/machine learning data prep/stroke_post_synth.PNG" alt="post smote" style="width:65%;padding:2%;" class="center">
      </div>
    </div>

    <!--CORRELATIONS-->
    <div class="row" style="margin-top:5%">
      <div class = "col-md-12">
          <h3><b>Correlations</b></h3>
          <br>
      </div>
    </div>
    <div class="row">
      <div class = "col-md-12">
        <blockquote class="blockquote">
            <p class="mb-0">
              <img src="../static/images/machine learning data prep/correlation_heat_map.PNG" alt = "heat map" style="float:left;width:35%;padding:2%;">
              Correlation heatmap 
            </p>
        </blockquote>
      </div>
    </div>
    <br>

    <!--MACHINE LEARNING-->
    <div class="row" style="margin-top:5%">
      <div class = "col-md-12">
          <h3><b>Machine Learning</b></h3>
          <br>
      </div>
    </div>
    <div class="row">
      <div class = "col-lg-12">
          <blockquote class="blockquote">
              <p class="mb-0">The primary objective of the evaluation process was to identify a model
                that did not over fit the data, generated the highest f1-score for 1 (Yes for stroke) 
                model and generated the highest recall for 1.  The large number of 0 values (No for stroke), 
                ensured a good f1-score for 0, but our objective was to identify a model that will give 
                the best 1 results and that presented a challenge for the models.</p>
                <p>
                <br>
                Linear models were evaluated first.
              </p>
                Models evaluated were LogisticRegression, KNeighborsClassifier and Support Vector Machines (svm).  
                The class_weight = “balanced” was set for LogisticRegression and svm.  The n-neighbors = 20 was set 
                for KNeighborsClassifier.
              </p>
              <p>The best results for the linear models was LogisticRegression with an Out Sample f1-score of 
                0.23.  KNeighborsClassifier and svm gave 0.16 and 0.19, respectively.
              </p>
              <p>
                Tree models were next.
              </p>
              Models evaluated were DecisionTreeClassifier, RandomForestClassifier, AdaBoostClassifier, 
              GradientBoostingClassifier and XGBClassifier.  The random_state = 42 was set for each tree model.  
              The n_estimators = 1000 was set for RandomForestClassifier, AdaBoostClassifier and GradientBoostingClassifier.  
              The use_label_encoder = False was set for XGBClassifier.   
              </p>
              <p>The best results for the tree models were AdaBoostClassifier and GradientBoostingClassifier with 
                Out Sample f1-scores of 0.24 and 0.26, respectively.  DecisionTreeClassifier, RandomForestClassifier 
                and XGBClassifier gave 0.13, 0.16 and 0.14, respectively.  Upon further evaluation, AdaBoostClassifier 
                and GradientBoostingClassifier gave recall values of 0.30 and 0.20.  In each case, the models had a 
                high value of missed 1 (Yes for Stroke) in the Out Samples.
              </p>
          </blockquote>
      </div>
    </div>
    <br>
    <div class="row">
      <div class = "col-md-4">
        <h5>Best Linear Model: LogisticRegression</h5>
          <blockquote class="blockquote">
              <p class="mb-0">
                LogisticRegression was chosen as the best 
                Liner Model based on f1-score of 0.23 and 
                recall of 0.80.
              </p>
          </blockquote>
      </div>
      <div class = "col-md-4">
        <h5>Best Tree Model 1: AdaBoostClassifier</h5>
          <blockquote class="blockquote">
              <p class="mb-0">AdaBoostClassifier was chosen as option 1 of the 
                Tree models.  It gave a f1-score of 0.24 and a recall of 0.30. 
              </p>
          </blockquote>
      </div>
      <div class = "col-md-4">
        <h5>Best Tree Model 2: GradientBoostingClassifier</h5>
          <blockquote class="blockquote">
              <p class="mb-0">GradientBoostingClassifier was chosen as option 
                2 of the Tree models.  It gave a f1-score of 0.26 and a recall 
                of 0.20.
              </p>
          </blockquote>
      </div>
    </div>
    <div class="row">
      <div class = "col-md-4">
        <img src="../static/images/machine learning/eval_loregress.PNG" alt="logress" style="width:65%;padding:2%;" class="center">
      </div>
      <div class = "col-lg-4">
        <img src="../static/images/machine learning/ada.PNG" alt="ada" style="width:65%;padding:2%;" class="center">
      </div>
      <div class = "col-lg-4">
        <img src="../static/images/machine learning/gradientboost.PNG" alt="gradient" style="width:65%;padding:2%;" class="center">
      </div>
    </div>

    <!-- MODEL SELECTION -->
    <div class="row" style="margin-top:5%">
      <div class = "col-md-12">
          <h3><b>Model Selection</b></h3>
          <br>
      </div>
    </div>
    <div class="row">
      <div class = "col-md-12">
        <blockquote class="blockquote">
            <p class="mb-0">
              <img src="../static/images/machine learning/model_selection.PNG" alt = "model selection" style="float:left;width:35%;padding:2%;">
              <br>
              <br>
              When reviewing the best of the respective Liner and Trees models, the Tree models had the best f1-scores, but extremely 
              poor recall values.  Therefore, LogisticRegression was selected with a little lower f1-score, but much better recall value.
            </p>
        </blockquote>
      </div>
    </div>

    <!-- FULL DATASET RUNMODEL SELECTION -->
    <div class="row" style="margin-top:5%">
      <div class = "col-md-12">
          <h3><b>Model Run Full Dataset</b></h3>
          <br>
      </div>
      </div>
      <div class="row">
        <div class = "col-md-12">
          <blockquote class="blockquote">
              <p class="mb-0">
                <img src="../static/images/machine learning/loregress_final.PNG" alt = "final logress run" style="float:left;width:35%;padding:2%;">
                <br>
                <br>
                After LogisticRegression was selected as the model to be used, it run with class_weight = balanced, max_iter = 1000
                and random_state = 42.   
              </p>
          </blockquote>
        </div>
      </div>

    <!--FEATURE IMPORTANCE-->
    <div class="row" style="margin-top:5%">
      <div class = "col-md-12">
          <h3><b>Feature Importance</b></h3>
          <br>
      </div>
    </div>
    <div class="row">
      <div class = "col-lg-12">
          <blockquote class="blockquote">
              <p class="mb-0">Feature importance in the model selected.
              </p>
          </blockquote>
      </div>
    </div>
    <br>
    <div class="row">
      <div class = "col-md-12">
        <img src="../static/images/machine learning data prep/Correlation Chart.PNG" alt="feature" style="width:65%;padding:2%;" class="center">
      </div>
    </div>

    <!--LIVE MODEL TESTING-->
    <div class="row" style="margin-top:5%">
      <div class = "col-md-12">
          <h3><b>Live Model Testing</b></h3>
          <br>
      </div>
      </div>
      <div class="row">
        <div class = "col-md-12">
          <blockquote class="blockquote">
              <p class="mb-0">
                <img src="../static/images/model testing/test2.PNG" alt = "live test1" style="float:left;width:35%;padding:2%;">
                <br>
                <br>
                Testing of the model provides expected results as more comorbidities are added  
              </p>
          </blockquote>
        </div>
      </div>

    <!--TABLEAU-->
    <div class="row" style="margin-top:5%">
      <div class = "col-md-12">
          <h3><b>Data Manipulation for Tableau</b></h3>
          <br>
      </div>
    </div>
    <div class="row">
      <div class = "col-md-12">
          <blockquote class="blockquote">
            <img src="../static/images/tableau_subset.png" alt = "Month Loop" style="float:left;width:35%;padding:2%;">
              <p class="mb-0">Based on all of the cleaning techniques we performed, we utilized a subset 
                of this data of our Tableau visualizations.  After the aforementioned cleaning, our dataset
                  was still larger than allowed for Tableau; therefore, we took a random subset of 0.6 of the 
                  dataset to be used with Tableau.
              </p>
          </blockquote>
      </div>
    </div>
  </div>
</body>

</html>